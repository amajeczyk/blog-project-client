(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[,,,,,,,,,,,,,,,,,function(e,t,a){},function(e,t,a){},,,,function(e,t,a){e.exports=a(37)},,,,,function(e,t,a){},function(e,t,a){},,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),c=a(19),l=a.n(c),o=(a(27),a(6)),s=a(7),u=a(9),i=a(8),m=(a(28),a(2)),h=a(12),p=a(3),d=a.n(p),f=a(4),b=(a(17),function(e){Object(u.a)(a,e);var t=Object(i.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={username:"",textPassword:""},e.handelSubmit=function(){var t=Object(f.a)(d.a.mark(function t(a){var n;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.props.navigation,a.preventDefault(),t.next=4,fetch("http://localhost:3001/users/login",{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/json"},body:JSON.stringify(e.state)}).then(function(e){return e.json()}).then(function(e){"ok"===e.status?(localStorage.setItem("currentUser",e.token),n("/")):alert("Invalid username/password")});case 4:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),e.handleChange=function(t){var a=t.target.name;e.setState(Object(h.a)({},a,t.target.value))},e}return Object(s.a)(a,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("div",{className:"content-wrapper"},r.a.createElement("div",{className:"header"},"Login"),r.a.createElement("div",{className:"content"},r.a.createElement("form",{className:"form",onSubmit:this.handelSubmit},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"username"},"Username:"),r.a.createElement("input",{type:"text",name:"username",placeholder:"username",onChange:this.handleChange})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"password"},"Password:"),r.a.createElement("input",{type:"password",name:"textPassword",placeholder:"password",onChange:this.handleChange})),r.a.createElement("button",{type:"submit",className:"button"},"Login")))))}}]),a}(r.a.Component)),g=function(e){var t=Object(m.f)();return r.a.createElement(b,Object.assign({},e,{navigation:t}))},v=a(5),E=a(20),j=[{title:"Create blog",path:"/products",icon:r.a.createElement(E.a,null),cName:"nav-text"}],O=a(0),w=(a(18),a(21)),N=localStorage.getItem("currentUser"),k={authenticateRequest:function(){return y.apply(this,arguments)},logout:function(){N=null,localStorage.removeItem("currentUser")},getTokenFromLocalStorage:function(){return localStorage.getItem("currentUser")}};function y(){return(y=Object(f.a)(d.a.mark(function e(){var t;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(N=localStorage.getItem("currentUser")){e.next=3;break}return e.abrupt("return",null);case 3:return t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({authToken:N})},e.next=6,fetch("http://localhost:3001/users/authenticate",t).then(function(e){return e.json()});case 6:if(!e.sent.authentication){e.next=9;break}return e.abrupt("return",Object(w.a)(N));case 9:return e.abrupt("return",null);case 10:case"end":return e.stop()}},e)}))).apply(this,arguments)}var C=function(e){var t=Object(m.f)(),a=Object(n.useState)(null),c=Object(v.a)(a,2),l=c[0],o=c[1];return Object(n.useEffect)(function(){k.authenticateRequest().then(function(e){o(e)})},[]),r.a.createElement(r.a.Fragment,null,r.a.createElement(O.b.Provider,{value:{color:"#fff",size:"1.05rem"}},r.a.createElement("nav",{className:"nav-menu"},r.a.createElement("ul",{className:"nav-menu-items"},r.a.createElement("li",{className:"navbar-toggle"},r.a.createElement("h2",{className:"blog-logo",onClick:function(){t("/")}},"BLOG IT!")),j.map(function(e,a){return r.a.createElement("li",{key:a,className:e.cName},r.a.createElement("button",{className:"button-38",onClick:function(){t("/addBlog")}},r.a.createElement("div",{className:"icon-wrapper"},e.icon,r.a.createElement("span",{className:"title-span"},e.title))))})),l?r.a.createElement("div",{onClick:k.authenticateRequest,className:"button-wrapper"},r.a.createElement("button",{className:"button-38",onClick:function(){t("/account")}},"Account")):r.a.createElement("div",{className:"button-wrapper"},r.a.createElement("button",{className:"button-38",onClick:function(){t("/login")}},"Log in")),l?r.a.createElement("div",{className:"button-wrapper"},r.a.createElement("button",{className:"button-38",onClick:function(){k.logout(),o(null),t("/")}},"Log out")):r.a.createElement("div",{className:"button-wrapper"},r.a.createElement("button",{className:"button-38",onClick:function(){t("/register")}},"Register")))))},x=a(15);a(30);var S=function(e){var t=Object(m.f)(),a=e.dataFromParent;return r.a.createElement("div",{className:"blog-element-wrapper",onClick:function(){t("/blog/".concat(a.id))}},r.a.createElement("div",{className:"blog-title"},r.a.createElement("h3",null,a.title),r.a.createElement("span",null,a.creationDate)),r.a.createElement("div",{className:"contnet"},a.blogText),r.a.createElement("div",{className:"blog-footer"},r.a.createElement("span",{className:"author"},"Author: "+a.username),r.a.createElement("span",{className:"readCount"},a.readCount)))};a(31);function T(e){var t=new Date;e.forEach(function(e){t.setTime(parseInt(e.creationDate,10)),e.creationDate=t.toLocaleDateString("en-us",{weekday:"long",year:"numeric",month:"short",day:"numeric"})})}var F=function(e){Object(u.a)(a,e);var t=Object(i.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).fetchArticels=Object(f.a)(d.a.mark(function e(){var t;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("http://localhost:3001/articels/main",{method:"GET"}).then(function(e){return e.json()});case 2:if("ok"!==(t=e.sent).status){e.next=9;break}return T(t.data),n.setState({blogs:t.data}),e.abrupt("return");case 9:case"end":return e.stop()}},e)})),n.fetchNewArticels=Object(f.a)(d.a.mark(function e(){var t,a;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("http://localhost:3001/articels/get/new/blogs",{method:"GET",headers:{blogsalreadydisplayed:n.state.blogs.map(function(e){return e.id})}}).then(function(e){return e.json()});case 2:T((t=e.sent).data),(a=[]).push.apply(a,Object(x.a)(n.state.blogs)),a.push.apply(a,Object(x.a)(t.data)),n.setState({blogs:a});case 8:case"end":return e.stop()}},e)})),n.state={blogs:[]},n.fetchArticels(),n}return Object(s.a)(a,[{key:"render",value:function(){var e=this.state.blogs;return r.a.createElement("div",{className:"main-content-wrapper"},r.a.createElement("h1",{className:"blog-info"}," There are some blogs to read"),r.a.createElement("hr",null),e.map(function(e){return e?r.a.createElement("div",{key:e.id},r.a.createElement(S,{dataFromParent:e}),r.a.createElement("hr",null)):r.a.createElement("div",null,"loading data...")}),r.a.createElement("div",{className:"load-more-wrapper",onClick:this.fetchNewArticels},"Click to load more blogs"))}}]),a}(r.a.Component),P=(a(32),function(e){Object(u.a)(a,e);var t=Object(i.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"footer"},r.a.createElement("h2",{className:"blog-it"},"BLOG IT!"))}}]),a}(r.a.Component));function B(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(C,null),r.a.createElement(F,null),r.a.createElement(P,null))}var A=function(e){Object(u.a)(a,e);var t=Object(i.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={username:"",email:"",textPassword:"",confirmPassword:"",info:"",color:"red"},e.handleSubmit=function(){var t=Object(f.a)(d.a.mark(function t(a){var n,r;return d.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a.preventDefault(),e.state.textPassword===e.state.confirmPassword){t.next=4;break}return e.setState({info:"Passwords do not match"}),t.abrupt("return");case 4:return n=e.props.navigation,t.next=7,fetch("http://localhost:3001/users/register",{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/json"},body:JSON.stringify(e.state)}).then(function(e){return e.json()});case 7:"ok"===(r=t.sent).status?(e.setState({info:"You created an account! You can login now!",color:"green"}),setTimeout(function(){n("/login")},1500)):(alert("fail:",r.error),e.setState({info:"Account with this email or username already exists."}));case 9:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),e.handleChange=function(t){var a=t.target.name;e.setState(Object(h.a)({},a,t.target.value))},e}return Object(s.a)(a,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("div",{className:"content-wrapper"},r.a.createElement("div",{className:"header"},"Registration"),r.a.createElement("div",{className:"content"},r.a.createElement("form",{className:"form",onSubmit:this.handleSubmit},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"username"},"Username:"),r.a.createElement("input",{type:"text",name:"username",placeholder:"username",onChange:this.handleChange})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"email"},"E-mail:"),r.a.createElement("input",{type:"email",name:"email",placeholder:"email",onChange:this.handleChange})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"password"},"Password:"),r.a.createElement("input",{type:"password",name:"textPassword",placeholder:"password",onChange:this.handleChange})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"password"},"Confirm password:"),r.a.createElement("input",{type:"password",name:"confirmPassword",placeholder:"confirm password",onChange:this.handleChange})),r.a.createElement("button",{type:"submit",className:"button"},"Sign up")),r.a.createElement("p",{className:"info",style:{color:this.state.color}},this.state.info))))}}]),a}(r.a.Component),L=function(e){var t=Object(m.f)();return r.a.createElement(A,Object.assign({},e,{navigation:t}))},I=(a(33),function(e){Object(u.a)(a,e);var t=Object(i.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).validateFields=function(){return/^[a-zA-Z0-9,#._ ]{6,80}$/i.test(n.state.title)?!!/^[a-zA-Z0-9,#._ ]{20,5000}$/i.test(n.state.blogtext)||(alert("Text must have between 20 and 5000 charcters"),!1):(alert("Title must have between 6 and 80 charcters"),!1)},n.handleSubmit=function(){var e=Object(f.a)(d.a.mark(function e(t){var a;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),n.validateFields()){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,fetch("http://localhost:3001/articels/add/blog",{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/json"},body:JSON.stringify(n.state)}).then(function(e){return e.json()});case 5:"ok"===(a=e.sent).status?alert(a.message):alert("fail:",a.message);case 7:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),n.handleChange=function(e){var t=e.target.name;n.setState(Object(h.a)({},t,e.target.value.trim()))},n.state={title:"",blogtext:"",authToken:"".concat(k.getTokenFromLocalStorage())},n}return Object(s.a)(a,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(C,null),r.a.createElement("div",{className:"main-add-blog"},r.a.createElement("form",{className:"form",onSubmit:this.handleSubmit},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Title:"),r.a.createElement("input",{type:"text",name:"title",placeholder:"Title",onChange:this.handleChange})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Write what you want:"),r.a.createElement("textarea",{name:"blogtext",placeholder:"Remember, be nice!",onChange:this.handleChange})),r.a.createElement("button",{type:"submit",className:"button"},"Post"))))}}]),a}(r.a.Component));a(34);var D,U=function(){var e=Object(m.f)();return r.a.createElement("div",{className:"go-to-login-main"},r.a.createElement("div",{className:"go-to-login-header"},"You have to login"),r.a.createElement("button",{className:"button",onClick:function(){e("/login")}},"Login"))},J=function(e){var t=e.children,a=Object(n.useState)(!1),c=Object(v.a)(a,2),l=c[0],o=c[1],s=Object(n.useState)({state:!1,data:{}}),u=Object(v.a)(s,2),i=u[0],m=u[1];return Object(n.useEffect)(function(){k.authenticateRequest().then(function(e){m({state:!0,data:e}),o(!!e)})},[]),i.state?l?r.a.cloneElement(t,{user:i.data}):r.a.createElement("div",null,r.a.createElement(U,null)):r.a.createElement("h1",null,"Checkin premission...")},R=(a(35),function(e){Object(u.a)(a,e);var t=Object(i.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).getUserBlogs=Object(f.a)(d.a.mark(function e(){var t;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("http://localhost:3001/articels/get/user/blogs",{method:"GET",headers:{authToken:n.state.authToken}}).then(function(e){return e.json()});case 2:if("ok"!==(t=e.sent).status){e.next=8;break}return n.setState({userBlogs:t.data}),e.abrupt("return");case 8:alert("Cannot get user's blogs");case 9:case"end":return e.stop()}},e)})),n.deleteBlog=function(){var e=Object(f.a)(d.a.mark(function e(t){var a,r,c;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.target.getAttribute("blogid"),t.stopPropagation(),e.next=4,fetch("http://localhost:3001/articels/delete",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({blogId:a,authToken:n.state.authToken})}).then(function(e){return e.json()});case 4:if("ok"!==(r=e.sent).status){e.next=10;break}return c=n.state.userBlogs.filter(function(e){return e.id!=r.blogId}),n.setState({userBlogs:c}),alert(r.message),e.abrupt("return");case 10:alert(r.message);case 11:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),n.redirectToBlogView=function(e){var t=e.target.getAttribute("id");n.props.navigate("/blog/".concat(t))},n.state={userBlogs:[],isFetched:!1,authToken:"".concat(k.getTokenFromLocalStorage())},n.getUserBlogs(),n}return Object(s.a)(a,[{key:"render",value:function(){var e=this,t=this.props.user,a=this.state.userBlogs;return r.a.createElement(r.a.Fragment,null,r.a.createElement(C,null),r.a.createElement("div",{className:"main-account-wrapper"},r.a.createElement("h1",null,"Hello ",t.username,"!"),r.a.createElement("div",{className:"blogs-deletion"},a.length?r.a.createElement("span",{className:"blog-info1"},"Here you can find your blogs"):r.a.createElement("span",{className:"blog-info1"},"You haven't created blog yet :("),a.map(function(t){return t?r.a.createElement("div",{id:t.id,key:t.id,className:"user-blog",onClick:e.redirectToBlogView},r.a.createElement("div",{className:"blog-title"},t.title),r.a.createElement("button",{className:"button-38",blogid:t.id,onClick:e.deleteBlog},"Delete")):r.a.createElement("div",null,"loading data...")}))))}}]),a}(r.a.Component)),G=(D=R,function(e){var t=Object(m.f)();return r.a.createElement(D,Object.assign({navigate:t},e))});a(36);var Y=function(e){var t=Object(m.g)().id,a=Object(n.useState)({}),c=Object(v.a)(a,2),l=c[0],o=c[1],s=Object(n.useState)(k.getTokenFromLocalStorage()),u=Object(v.a)(s,1)[0],i=function(){var e=Object(f.a)(d.a.mark(function e(){var a;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("http://localhost:3001/blog/".concat(t),{method:"GET"}).then(function(e){return e.json()});case 2:"ok"===(a=e.sent).status&&o(a.data.pop());case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();Object(n.useEffect)(function(){i()},[]);var h=function(){var e=Object(f.a)(d.a.mark(function e(){var a;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("http://localhost:3001/blog/upvote/".concat(t),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({authToken:u})}).then(function(e){return e.json()});case 2:if("Authentication failed"!=(a=e.sent).message){e.next=6;break}return alert("You have to log in to vote"),e.abrupt("return");case 6:alert(a.message);case 7:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();return r.a.createElement(r.a.Fragment,null,r.a.createElement(C,null),r.a.createElement("div",{className:"main-account-wrapper"},r.a.createElement("div",{className:"blog-view-title"},l.title?r.a.createElement(r.a.Fragment,null,l.title):r.a.createElement(r.a.Fragment,null,"Blog not found")),r.a.createElement("div",{className:"blog-view-content"},l.blogText?l.blogText:r.a.createElement(r.a.Fragment,null)),r.a.createElement("div",{className:"blog-view-footer"},r.a.createElement("button",{className:"button-38",onClick:h},"Up vote"))))},q=function(e){Object(u.a)(a,e);var t=Object(i.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"main-wrapper"},r.a.createElement(m.c,null,r.a.createElement(m.a,{path:"/addBlog",element:r.a.createElement(J,null,r.a.createElement(I,null))}),r.a.createElement(m.a,{path:"/account",element:r.a.createElement(J,null,r.a.createElement(G,null))}),r.a.createElement(m.a,{path:"/blog/:id",element:r.a.createElement(Y,null)}),r.a.createElement(m.a,{path:"/register",element:r.a.createElement(L,null)}),r.a.createElement(m.a,{path:"/login",element:r.a.createElement(g,null)}),r.a.createElement(m.a,{path:"/",element:r.a.createElement(B,null)})))}}]),a}(r.a.Component),z=a(11);l.a.render(r.a.createElement(z.a,null,r.a.createElement(q,null)),document.getElementById("root"))}],[[22,1,2]]]);
//# sourceMappingURL=main.a482a814.chunk.js.map